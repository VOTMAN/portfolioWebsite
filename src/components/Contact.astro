<section
  id="contact"
  class="relative min-h-screen flex flex-col items-center justify-center py-20 px-6 bg-gradient-to-b overflow-hidden"
>
  <h2 class="text-4xl font-bold mb-10 text-transparent bg-clip-text bg-gradient-to-r from-red-600 via-blue-500 to-violet-400 z-10">
    Get In Touch
  </h2>

  <div class="w-full max-w-2xl rounded-2xl p-8 shadow-lg border border-white/10 z-10">
    <div id="messageContainer" class="hidden mb-6 p-4 rounded-lg"></div>

    <form id="contactForm" class="flex flex-col gap-6">
      <div>
        <label for="name" class="block text-sm font-medium text-gray-300 mb-2">Name</label>
        <input
          type="text"
          id="name"
          name="name"
          required
          placeholder="Enter your name"
          class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-transparent"
        />
      </div>

      <div>
        <label for="email" class="block text-sm font-medium text-gray-300 mb-2">Email</label>
        <input
          type="email"
          id="email"
          name="email"
          required
          placeholder="Enter your email"
          class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-transparent"
        />
      </div>

      <div>
        <label for="message" class="block text-sm font-medium text-gray-300 mb-2">Message</label>
        <textarea
          id="message"
          name="message"
          rows="5"
          placeholder="Write your message..."
          class="w-full px-4 py-3 rounded-lg bg-white/10 border border-white/20 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-transparent"
        ></textarea>
      </div>

      <button
        type="submit"
        id="subBtn"
        class="w-full py-3 px-6 rounded-lg bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-semibold shadow-md hover:scale-[1.02] hover:shadow-lg transition-transform duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Send Message
      </button>
    </form>
  </div>
</section>

<script>
  const contactForm: HTMLFormElement | null = document.querySelector("#contactForm");
  const subBtn: HTMLButtonElement | null = document.querySelector("#subBtn");
  const messageContainer = document.querySelector("#messageContainer");

  function showMessage(message: string, isSuccess: boolean) {
    if (messageContainer) {
      messageContainer.textContent = message;
      messageContainer.className = `mb-6 p-4 rounded-lg ${
        isSuccess
          ? "bg-green-500/20 border border-green-500/50 text-green-300"
          : "bg-red-500/20 border border-red-500/50 text-red-300"
      }`;
      messageContainer.classList.remove("hidden");

      messageContainer.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }
  }

  if (contactForm && subBtn) {
    contactForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const name: HTMLInputElement | null = document.querySelector("#name");
      const email: HTMLInputElement | null = document.querySelector("#email");
      const message: HTMLInputElement | null = document.querySelector("#message");

      if (!name?.value || !email?.value || !message?.value) {
        showMessage("Please fill in all fields", false);
        return;
      }

      subBtn.disabled = true;
      subBtn.textContent = "Sending...";

      try {
        const response = await fetch("/api/contact", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            name: name.value,
            email: email.value,
            body: message.value,
          }),
        });

        const result = await response.json();

        if (result.success) {
          showMessage("Thank you! Your message has been sent successfully.", true);
          contactForm.reset();
        } else {
          showMessage(result.error || "Failed to send message. Please try again.", false);
        }
      } catch (error) {
        console.error("Error:", error);
        showMessage("An error occurred. Please try again later.", false);
      } finally {
        subBtn.disabled = false;
        subBtn.textContent = "Send Message";
      }
    });
  }
</script>